# Swagger API ë¬¸ì„œ ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”

NestJS í”„ë¡œì íŠ¸ì— Swagger/OpenAPI ë¬¸ì„œí™”ë¥¼ í†µí•©í•˜ì—¬ ìë™ API ë¬¸ì„œ ìƒì„± ì‹œìŠ¤í…œì„ êµ¬ì¶•í–ˆìŠµë‹ˆë‹¤.

## ğŸš€ ì ‘ì† ì •ë³´

### Swagger UI ì ‘ì†
```
ê°œë°œ í™˜ê²½: http://localhost:3000/api-docs
í”„ë¡œë•ì…˜: http://your-domain.com/api-docs
```

### API ê¸°ë³¸ ì •ë³´
- **ì œëª©**: ì¤‘ê³ ê±°ë˜ í”Œë«í¼ API
- **ë²„ì „**: 1.0
- **ì„¤ëª…**: ì¤‘ê³ ê±°ë˜ í”Œë«í¼ ë°±ì—”ë“œ API ë¬¸ì„œ

## ğŸ“¦ ì„¤ì¹˜ëœ íŒ¨í‚¤ì§€

```json
{
  "dependencies": {
    "@nestjs/swagger": "^11.2.0"
  }
}
```

## âš™ï¸ Swagger ì„¤ì •

### main.ts ì„¤ì •

```typescript
import { DocumentBuilder, SwaggerModule } from '@nestjs/swagger';

const config = new DocumentBuilder()
  .setTitle('ì¤‘ê³ ê±°ë˜ í”Œë«í¼ API')
  .setDescription('ì¤‘ê³ ê±°ë˜ í”Œë«í¼ ë°±ì—”ë“œ API ë¬¸ì„œ')
  .setVersion('1.0')
  .addTag('users', 'ì‚¬ìš©ì ê´€ë¦¬')
  .addTag('products', 'ìƒí’ˆ ê´€ë¦¬')
  .addTag('orders', 'ì£¼ë¬¸ ê´€ë¦¬')
  .addTag('payments', 'ê²°ì œ ê´€ë¦¬')
  .addTag('chat', 'ì±„íŒ… ì‹œìŠ¤í…œ')
  .addTag('notifications', 'ì•Œë¦¼ ì„œë¹„ìŠ¤')
  .addBearerAuth(
    {
      type: 'http',
      scheme: 'bearer',
      bearerFormat: 'JWT',
      name: 'JWT',
      description: 'JWT í† í°ì„ ì…ë ¥í•˜ì„¸ìš”',
      in: 'header',
    },
    'access-token',
  )
  .build();

const document = SwaggerModule.createDocument(app, config);
SwaggerModule.setup('api-docs', app, document, {
  swaggerOptions: {
    persistAuthorization: true, // ìƒˆë¡œê³ ì¹¨ ì‹œ ì¸ì¦ ì •ë³´ ìœ ì§€
    tagsSorter: 'alpha', // íƒœê·¸ ì•ŒíŒŒë²³ ìˆœ ì •ë ¬
    operationsSorter: 'alpha', // API ì—”ë“œí¬ì¸íŠ¸ ì•ŒíŒŒë²³ ìˆœ ì •ë ¬
  },
});
```

### ì£¼ìš” ì„¤ì • ì˜µì…˜

| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| `persistAuthorization` | ìƒˆë¡œê³ ì¹¨ ì‹œ JWT í† í° ìœ ì§€ |
| `tagsSorter` | íƒœê·¸ ì •ë ¬ ë°©ì‹ (alpha/method) |
| `operationsSorter` | API ì—”ë“œí¬ì¸íŠ¸ ì •ë ¬ ë°©ì‹ |

## ğŸ·ï¸ API íƒœê·¸ êµ¬ì¡°

í˜„ì¬ ì •ì˜ëœ API íƒœê·¸:

1. **health** - ì„œë²„ ìƒíƒœ í™•ì¸
2. **users** - ì‚¬ìš©ì ê´€ë¦¬
3. **products** - ìƒí’ˆ ê´€ë¦¬
4. **orders** - ì£¼ë¬¸ ê´€ë¦¬
5. **payments** - ê²°ì œ ê´€ë¦¬
6. **chat** - ì±„íŒ… ì‹œìŠ¤í…œ
7. **notifications** - ì•Œë¦¼ ì„œë¹„ìŠ¤

## ğŸ”§ ë°ì½”ë ˆì´í„° ì‚¬ìš©ë²•

### 1. ì»¨íŠ¸ë¡¤ëŸ¬ ë ˆë²¨

```typescript
import { ApiTags } from '@nestjs/swagger';

@ApiTags('users') // API íƒœê·¸ ì§€ì •
@Controller('users')
export class UsersController {}
```

### 2. ì—”ë“œí¬ì¸íŠ¸ ë ˆë²¨

```typescript
import { ApiOperation, ApiResponse } from '@nestjs/swagger';

@Get('health')
@ApiOperation({
  summary: 'ì„œë²„ ìƒíƒœ í™•ì¸',
  description: 'ì„œë²„ì˜ í˜„ì¬ ìƒíƒœì™€ ë²„ì „ ì •ë³´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.'
})
@ApiResponse({
  status: 200,
  description: 'ì„œë²„ ìƒíƒœ ì •ë³´',
  schema: {
    type: 'object',
    properties: {
      status: { type: 'string', example: 'ok' },
      timestamp: { type: 'string', example: '2025-10-16T10:00:00.000Z' },
      version: { type: 'string', example: '1.0.0' }
    }
  }
})
getHealth() {
  return {
    status: 'ok',
    timestamp: new Date().toISOString(),
    version: '1.0.0',
  };
}
```

### 3. DTO ë¬¸ì„œí™”

```typescript
import { ApiProperty } from '@nestjs/swagger';

export class CreateUserDto {
  @ApiProperty({
    description: 'ì‚¬ìš©ì ì´ë©”ì¼',
    example: 'user@example.com',
  })
  email: string;

  @ApiProperty({
    description: 'ë¹„ë°€ë²ˆí˜¸',
    example: 'password123',
    minLength: 8,
  })
  password: string;

  @ApiProperty({
    description: 'ë‹‰ë„¤ì„',
    example: 'í™ê¸¸ë™',
    required: false,
  })
  nickname?: string;
}
```

### 4. ì¸ì¦ í† í° ì‚¬ìš©

```typescript
import { ApiBearerAuth } from '@nestjs/swagger';

@ApiBearerAuth('access-token')
@UseGuards(JwtAuthGuard)
@Get('profile')
getProfile(@Request() req) {
  return req.user;
}
```

### 5. ì—ëŸ¬ ì‘ë‹µ ë¬¸ì„œí™”

```typescript
@ApiResponse({ status: 200, description: 'ì„±ê³µ' })
@ApiResponse({ status: 400, description: 'ì˜ëª»ëœ ìš”ì²­' })
@ApiResponse({ status: 401, description: 'ì¸ì¦ ì‹¤íŒ¨' })
@ApiResponse({ status: 404, description: 'ë¦¬ì†ŒìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ' })
@ApiResponse({ status: 500, description: 'ì„œë²„ ì—ëŸ¬' })
```

## ğŸ“ ì£¼ìš” ë°ì½”ë ˆì´í„°

### ì»¨íŠ¸ë¡¤ëŸ¬ ë°ì½”ë ˆì´í„°
- `@ApiTags()` - API ê·¸ë£¹ íƒœê·¸
- `@ApiBearerAuth()` - JWT ì¸ì¦ í•„ìš”

### ì—”ë“œí¬ì¸íŠ¸ ë°ì½”ë ˆì´í„°
- `@ApiOperation()` - ì—”ë“œí¬ì¸íŠ¸ ì„¤ëª…
- `@ApiResponse()` - ì‘ë‹µ ìŠ¤í‚¤ë§ˆ
- `@ApiParam()` - ê²½ë¡œ íŒŒë¼ë¯¸í„°
- `@ApiQuery()` - ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°
- `@ApiBody()` - ìš”ì²­ ë°”ë””

### DTO ë°ì½”ë ˆì´í„°
- `@ApiProperty()` - DTO ì†ì„± ì •ì˜
- `@ApiPropertyOptional()` - ì„ íƒì  ì†ì„±

## ğŸ¯ ì‹¤ì œ ì‚¬ìš© ì˜ˆì œ

### í—¬ìŠ¤ ì²´í¬ ì—”ë“œí¬ì¸íŠ¸

```typescript
@ApiTags('health')
@Controller()
export class AppController {
  @Get()
  @ApiOperation({
    summary: 'í—¬ìŠ¤ ì²´í¬',
    description: 'API ì„œë²„ ìƒíƒœ í™•ì¸ì„ ìœ„í•œ í—¬ìŠ¤ ì²´í¬ ì—”ë“œí¬ì¸íŠ¸'
  })
  @ApiResponse({
    status: 200,
    description: 'ì„œë²„ ì •ìƒ ì‘ë™',
    schema: {
      type: 'string',
      example: 'Hello World!'
    }
  })
  getHello(): string {
    return 'Hello World!';
  }

  @Get('health')
  @ApiOperation({
    summary: 'ì„œë²„ ìƒíƒœ í™•ì¸',
    description: 'ì„œë²„ì˜ í˜„ì¬ ìƒíƒœì™€ ë²„ì „ ì •ë³´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.'
  })
  @ApiResponse({
    status: 200,
    description: 'ì„œë²„ ìƒíƒœ ì •ë³´',
    schema: {
      type: 'object',
      properties: {
        status: { type: 'string', example: 'ok' },
        timestamp: { type: 'string', example: '2025-10-16T10:00:00.000Z' },
        version: { type: 'string', example: '1.0.0' }
      }
    }
  })
  getHealth() {
    return {
      status: 'ok',
      timestamp: new Date().toISOString(),
      version: '1.0.0',
    };
  }
}
```

## ğŸ” JWT ì¸ì¦ ì„¤ì •

### 1. Bearer Token ì„¤ì •

main.tsì—ì„œ ì´ë¯¸ ì„¤ì •ë¨:

```typescript
.addBearerAuth(
  {
    type: 'http',
    scheme: 'bearer',
    bearerFormat: 'JWT',
    name: 'JWT',
    description: 'JWT í† í°ì„ ì…ë ¥í•˜ì„¸ìš”',
    in: 'header',
  },
  'access-token',
)
```

### 2. Swagger UIì—ì„œ ì¸ì¦

1. Swagger UI ìš°ì¸¡ ìƒë‹¨ **Authorize** ë²„íŠ¼ í´ë¦­
2. `access-token` ì„¹ì…˜ì— JWT í† í° ì…ë ¥
3. **Authorize** í´ë¦­
4. ì´í›„ ëª¨ë“  ì¸ì¦ í•„ìš” APIì— ìë™ìœ¼ë¡œ í† í° í¬í•¨

## ğŸ“š ì¶”ê°€ ë¦¬ì†ŒìŠ¤

### NestJS Swagger ê³µì‹ ë¬¸ì„œ
- https://docs.nestjs.com/openapi/introduction

### OpenAPI ëª…ì„¸
- https://swagger.io/specification/

## ğŸ› ï¸ ê°œë°œ íŒ

### 1. ìë™ DTO ìƒì„±

```bash
# CLIë¥¼ í†µí•œ DTO ìƒì„±
nest g class users/dto/create-user.dto --no-spec
```

### 2. Swagger JSON ë‹¤ìš´ë¡œë“œ

Swagger ë¬¸ì„œë¥¼ JSON í˜•ì‹ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œ:
```
http://localhost:3000/api-docs-json
```

### 3. í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ ë¹„í™œì„±í™”

```typescript
// main.ts
if (process.env.NODE_ENV !== 'production') {
  // Swagger ì„¤ì •
}
```

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

ìƒˆë¡œìš´ API ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€ ì‹œ:

- [ ] `@ApiTags()` íƒœê·¸ ì§€ì •
- [ ] `@ApiOperation()` ì„¤ëª… ì¶”ê°€
- [ ] `@ApiResponse()` ì‘ë‹µ ìŠ¤í‚¤ë§ˆ ì •ì˜
- [ ] DTOì— `@ApiProperty()` ì¶”ê°€
- [ ] ì¸ì¦ í•„ìš” ì‹œ `@ApiBearerAuth()` ì¶”ê°€
- [ ] ì—ëŸ¬ ì‘ë‹µ ë¬¸ì„œí™”

## ğŸ“Œ ë‹¤ìŒ ë‹¨ê³„

1. **DTO í´ë˜ìŠ¤ ìƒì„±** - ê° ëª¨ë“ˆë³„ ìš”ì²­/ì‘ë‹µ DTO
2. **ì—ëŸ¬ ì‘ë‹µ í‘œì¤€í™”** - ê³µí†µ ì—ëŸ¬ ì‘ë‹µ í¬ë§·
3. **API ë²„ì €ë‹** - v1, v2 ë“± ë²„ì „ ê´€ë¦¬
4. **ì˜ˆì œ ë°ì´í„°** - ì‹¤ì œ ì‚¬ìš© ê°€ëŠ¥í•œ ì˜ˆì œ ì¶”ê°€
